# =============================================================================
# Creative Studio SaaS - Environment Variables
# =============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit the .env file to version control!

# =============================================================================
# CORS Configuration (Backend - Express BFF & Cloudflare Functions)
# =============================================================================
# Comma-separated list of allowed origins for CORS
# Production: https://creative-studio-saas.pages.dev
# Local dev: http://localhost:5173,http://localhost:3000
ALLOWED_ORIGINS=https://creative-studio-saas.pages.dev,http://localhost:5173

# =============================================================================
# Frontend Configuration (Vite)
# =============================================================================
# Base URL for API calls (optional - will auto-detect if not set)
# For production: https://creative-studio-saas-production.up.railway.app/api
# For local dev: http://localhost:8080/api
VITE_API_BASE_URL=

# Supabase Configuration
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key-here

# =============================================================================
# Backend Configuration (Express BFF Server - server.js)
# =============================================================================
# Port for Express server (Railway will override this)
PORT=8080

# Supabase Configuration (Backend)
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here

# Stock API Configuration
STOCK_API_KEY=your-stock-api-key
STOCK_API_BASE_URL=https://nehtw.com/api

# Session Configuration
SESSION_COOKIE_NAME=css_bff_session
SESSION_SECRET=your-secret-key-here-change-in-production
SESSION_TTL_MS=28800000
SESSION_REFRESH_THRESHOLD_MS=1800000

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=120
RATE_LIMIT_ADMIN_MAX_REQUESTS=60

# Admin Configuration
ADMIN_DEFAULT_LIMIT=50
ADMIN_MAX_LIMIT=200

# Environment
NODE_ENV=production

# JWT Verification (only set to true for development/testing)
ALLOW_UNVERIFIED_JWT=false

# Audit Log Path (optional)
AUDIT_LOG_PATH=./logs/audit.log

# =============================================================================
# Cloudflare Functions Environment Variables
# =============================================================================
# These should be set in Cloudflare Pages dashboard under Settings > Environment Variables

# Stock API (for Cloudflare Functions)
# STOCK_API_KEY=your-stock-api-key
# STOCK_API_BASE_URL=https://nehtw.com/api

# Supabase (for Cloudflare Functions)
# SUPABASE_URL=https://your-project.supabase.co
# SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here
# SUPABASE_ANON_KEY=your-anon-key-here

# =============================================================================
# Railway Deployment Variables (Set in Railway Dashboard)
# =============================================================================
# These variables should be configured in the Railway project settings:
# - ALLOWED_ORIGINS=https://creative-studio-saas.pages.dev
# - SUPABASE_URL=https://your-project.supabase.co
# - SUPABASE_SERVICE_ROLE_KEY=your-service-role-key
# - STOCK_API_KEY=your-stock-api-key
# - SESSION_SECRET=your-production-secret
# - NODE_ENV=production

# =============================================================================
# Development Setup Instructions
# =============================================================================
# 1. Copy this file: cp .env.example .env
# 2. Fill in your Supabase credentials from https://app.supabase.com
# 3. Get your Stock API key from your provider
# 4. Generate a secure SESSION_SECRET: openssl rand -base64 32
# 5. For local development, use: ALLOWED_ORIGINS=http://localhost:5173
# 6. Never commit the .env file to version control!

# =============================================================================
# Production Deployment Checklist
# =============================================================================
# ✅ Set ALLOWED_ORIGINS to your production domain
# ✅ Set strong SESSION_SECRET (use: openssl rand -base64 32)
# ✅ Set NODE_ENV=production
# ✅ Configure Supabase with service role key
# ✅ Set Stock API credentials
# ✅ Configure CORS on both Railway and Cloudflare Pages
# ✅ Verify all API endpoints are accessible
# ✅ Test authentication flow end-to-end
# ✅ Monitor logs for any CORS errors

# =============================================================================
# Troubleshooting CORS Issues
# =============================================================================
# If you see CORS errors:
# 1. Verify ALLOWED_ORIGINS includes your frontend domain (no trailing slash)
# 2. Check that frontend domain matches exactly (https vs http, www vs non-www)
# 3. Ensure Railway has ALLOWED_ORIGINS environment variable set
# 4. Verify Cloudflare Functions are not adding conflicting headers
# 5. Clear browser cache and test in incognito mode
# 6. Check browser console for the exact CORS error message
# 7. Verify backend is returning correct Access-Control-Allow-Origin header
